10   CLS
20   DIMZ(14,14)
30   DIMR(7,4)
40   DIMP(7)
50   FORX=0TO7
60   CHARX,0044BB000011EE
70   NEXT
80   COLOR1,8,5
90   CHAR8,82442810284482
95   COLOR2,10,5
100  CHAR24,00
110  COLOR4,13,13
115  CHAR64,00000804FE0408
120  CHAR126,78444478444478
130  CHAR127,102844447C4444
140  CHAR123,78444478404040
150  CHAR124,7C404070404040
160  CHAR125,78444444444478
170  COLOR16,9,5
180  CHAR113,4444447C444444
190  CHAR114,41635549414141
200  CHAR115,78444478404040
210  CHAR116,7C404070404040
220  CHAR117,78444444444478
230  CHAR118,78444478444478
240  CHAR119,102844447C4444
245  IFL=3ORL=4THEN3120
250  COLOR15,16,5
260  CHAR16,101000C6001010
270  COLOR3,16,5
280  CHAR128,0000001818
290  CHAR129,000018242418
300  CHAR130,003C424242423C
310  CHAR131,3C4281818181423C
320  COLOR17,8,5
330  CHAR136,0000001810
340  CHAR137,00003812200C
350  CHAR138,00384400408468
360  CHAR139,2681000000A04221
370  COLOR18,7,5
380  CHAR144,0000000003783F1F
390  CHAR145,0000000EDEDFFFFF
400  CHAR146,0000000000C0FFFE
410  CHAR147,00000001F87F3F0F
420  CHAR148,000000EEE6FFFFFF
430  CHAR149,0000061E3FFFFFFF
440  CHAR150,000000000FFFFFFF
450  CHAR151,0000000000FFFEFC
460  COLOR19,15,2
470  CHAR152,000000FF783F0F07
480  CHAR153,000000FF44FFFFFF
490  CHAR154,0E0E1FFF7CFFFFFF
500  CHAR155,000000FF46FFFEFC
510  CHAR156,00000000F17C3F0F
520  CHAR157,00000103CFDFFFFF
530  CHAR158,00C0D0F8FFFFFFFF
540  CHAR159,000000000080FFFE
550  COLOR20,15,2
560  CHAR160,000001F87F3F1F07
570  CHAR161,0000EFE7FFFFFFFF
580  CHAR162,061E1E3FFFFFFFFF
590  CHAR163,0000001ECEFFFFFF
600  CHAR164,000000F0E3FFFFFF
610  CHAR165,00000000F0FFFFFE
620  COLOR21,15,2
630  FORX=5TO12
640  COLORX,8,2
650  NEXT
660  COLOR0,5
670  PRINT"     E SHIPS."
680  PRINT
690  PRINTTAB(12);"B"
700  PRINTTAB(12);"Y"
710  FORX=1TO3
720  PRINT
730  NEXT
740  PRINTTAB(10);"M.J.H"
750  PRINT
760  PRINT"<CNT'L> TO MOVE UP."
770  PRINT"<SHIFT> TO MOVE DOWN."
780  PRINT"<-> TO MOVE LEFT."
790  PRINT"<@> TO MOVE RIGHT."
800  PRINT"<CNT'L>+<-> TO FIRE."
805  PRINT"<SHIFT>+<@> TO SURRENDER."
810  E$="BATTL"
820  FORX=1TO5
830  F$=MID$(E$,X,1)
840  PLOTX+2,X+3,ASC(F$)
850  NEXT
860  PLOT18,15,65
870  PLOT19,14,76
880  PLOT20,13,76
890  PRINT
900  PRINT"SKILL LEVEL (1-4)";
910  INPUTL
920  O=1
930  P=2
940  IFL=1ORL=2THEN980
950  FORX=115TO119
960  CHARX,4444447C444444
970  NEXT
980  B$=""
990  D$=""
1000 A$=CHR$(24)
1010 FORX=1TO16
1020 B$=B$+A$
1030 NEXT
1040 C$=CHR$(1)
1050 FORX=1TO14
1060 D$=D$+C$
1070 NEXT
1080 PRINT
1090 PRINTTAB(6);B$
1100 FORX=1TO14
1110 PRINTTAB(6);A$;D$;A$
1120 NEXT
1130 PRINTTAB(6);B$
1140 PRINT
1150 PRINT"AIRCRAFT CARRIER:0 (7)"
1160 PRINT"BATTLESHIPS.....:0 (6) SHOTS"
1170 PRINT"DESTROYERS......:0 (5)"
1180 PRINT"FRIGATES........:0 (4)  100"
1190 PRINT"PATROL BOATS....:0 (3)"
1200 DATA1,2,3,3,4
1210 FORE=7TO3STEP-1
1220 READF
1230 FORG=1TOF
1240 P(E)=G
1250 A=RND(3)-2
1260 FORQ=1TOA*3+4
1270 NEXT
1280 B=RND(3)-2
1290 FORQ=1TOA*3+4
1300 NEXT
1310 IFA=0ANDB=0THEN1250
1320 C=RND(14)
1330 FORQ=1TOC
1340 NEXT
1350 D=RND(14)
1360 M=C
1370 N=D
1380 FORX=1TOE
1390 IFM<1ORM>14THEN1630
1400 IFN<1ORN>14THEN1630
1410 IFZ(M,N)>0THEN1630
1420 M=M+A
1430 N=N+B
1440 NEXT
1450 FORX=1TOE
1460 Z(C,D)=E+G/10
1470 C=C+A
1480 D=D+B
1490 NEXT
1500 GOSUB2500
1510 NEXT
1520 NEXT
1530 G=100
1540 IFL=1ORL=3THEN1660
1550 FORX=1TO5
1560 A=RND(14)
1570 FORQ=1TOA
1580 NEXT
1590 B=RND(14)
1600 IFZ(A,B)>0THEN1560
1610 Z(A,B)=2
1620 NEXT
1625 GOTO1660
1630 X=E
1640 NEXT
1650 GOTO1250
1660 X=1
1670 Y=1
1675 IFG=0THEN3100
1680 A=JOY(4)
1690 PLOTX+9,Y+2,Z(X,Y)
1700 B=JOY(3)
1710 IFB=2ANDA=1THEN1920
1720 IFB=1THEN1790
1730 IFA=2THEN1820
1740 PLOTX+9,Y+2,16
1750 IFB=2THEN1850
1760 IFA=1THEN1880
1770 IFB=1ANDA=2THEN3100
1780 GOTO1680
1790 Y=Y+1
1800 IFY>14THENY=1
1810 GOTO1730
1820 X=X+1
1830 IFX>14THENX=1
1840 GOTO1740
1850 PLOTX+9,Y+2,Z(X,Y)
1855 Y=Y-1
1860 IFY<1THENY=14
1870 GOTO1760
1880 PLOTX+9,Y+2,Z(X,Y)
1885 X=X-1
1890 IFX<1THENX=14
1900 GOTO1680
1910 G=G-1
1915 PLOTX+9,Y+2,114
1916 Z(X,Y)=114
1920 G=G-1
1930 IFG<0THENG=0
1940 A$=STR$(G)
1950 F=LEN(A$)
1960 IFF=2THENA$=" "+A$
1970 IFF=1THENA$="  "+A$
1980 FORR=1TO3
1990 B$=MID$(A$,R,1)
2000 PLOTR+26,22,ASC(B$)
2010 NEXT
2030 IFZ(X,Y)>100ANDZ(X,Y)<130THEN1675
2040 IFZ(X,Y)>0.1ANDZ(X,Y)<8THEN2120
2050 Z(X,Y)=8
2060 FORQ=1TO4
2070 PLOTX+9,Y+2,Q+127
2080 FORI=1TOQ
2090 NEXT
2100 NEXT
2110 GOTO1675
2120 IFZ(X,Y)=2THEN1910
2130 S=Z(X,Y)-INT(Z(X,Y))
2140 S=INT((S+0.01)*10)
2150 T=INT(Z(X,Y))
2160 R(T,S)=R(T,S)+1
2170 Z(X,Y)=Z(X,Y)+112
2180 FORQ=1TO4
2190 PLOTX+9,Y+2,Q+135
2200 FORI=1TO5-Q
2210 NEXT
2220 NEXT
2230 PLOTX+9,Y+2,Z(X,Y)
2240 IFR(T,S)=TTHENGOTO2260
2250 GOTO1675
2260 A=X-T+1
2270 IFA<1THENA=1
2280 B=X+T-1
2290 IFB>14THENB=14
2300 C=Y-T+1
2310 IFC<1THENC=1
2320 D=Y+T-1
2330 IFD>14THEND=14
2340 J=INT((Z(X,Y)+0.01)*10)
2350 FORU=ATOB
2360 FORV=CTOD
2370 I=INT((Z(U,V)+0.01)*10)
2380 IFI<>JTHEN2410
2390 Z(U,V)=Z(U,V)+8
2400 PLOTU+9,V+2,Z(U,V)
2410 NEXT
2420 NEXT
2430 GOSUB2490
2440 GOSUB(INT(Z(X,Y)-120)*100)+2300
2450 P=P+2
2455 W=W+1
2460 IFP=16THENO=25
2470 IFP=16THENP=2
2475 IFW=13THEN3295
2480 GOTO1675
2490 P(T)=P(T)-1
2500 FORC=7TO3STEP-1
2510 PLOT20,26-C,P(C)+48
2520 NEXT
2530 RETURN
2600 PLOTO+2,P,144
2610 PLOTO+3,P,145
2620 PLOTO+4,P,146
2630 RETURN
2700 PLOTO+1,P,156
2710 PLOTO+2,P,157
2720 PLOTO+3,P,158
2730 PLOTO+4,P,159
2740 RETURN
2800 FORQ=147TO151
2810 PLOTO+Q-146,P,Q
2820 NEXT
2830 RETURN
2900 FORQ=160TO165
2910 PLOTO+Q-160,P,Q
2920 NEXT
2930 RETURN
3000 PLOTO,P,152
3010 PLOTO+1,P,153
3020 PLOTO+2,P,153
3030 PLOTO+3,P,154
3040 PLOTO+4,P,153
3050 PLOTO+5,P,153
3060 PLOTO+6,P,155
3070 RETURN
3100 COLOR4,7,7
3110 IFL=3ORL=4THEN180
3120 FORX=1TO14
3130 FORY=1TO14
3140 IFZ(X,Y)>0.1ANDZ(X,Y)<8THENZ(X,Y)=Z(X,Y)+112
3145 IFZ(X,Y)>0ANDZ(X,Y)<0.1THENZ(X,Y)=0
3150 IFZ(X,Y)>130THENZ(X,Y)=0
3160 PLOTX+9,Y+2,Z(X,Y)
3170 NEXT
3180 NEXT
3190 M$="<SHIFT> TO ESCAPE"
3200 FORX=1TO17
3210 B$=MID$(M$,X,1)
3220 PLOTX+8,18,ASC(B$)
3230 NEXT
3240 A=JOY(3)
3250 IFA=0ORA=2THEN3240
3260 CLS
3270 IFB=0ORW=13THEN3300
3280 PRINT"ENEMY WIN...                  "
3290 GOTO3340
3295 CLS
3300 PRINT"CONGRATULATIONS!              "
3310 PRINT"YOU HAVE SUCCESSFULLY        "
3320 PRINT"COMPLETED YOUR MISSION OF    "
3330 PRINT"DESTROYING THE ENEMY FLEET.  "
3340 PRINT"IN ";100-G;" SHOTS YOU SUNK"
3350 PRINT
3360 PRINTW;" ENEMY SHIPS."
3370 FORX=1TO5
3380 PRINT
3390 NEXT
3400 PRINT"CAN YOU HANDLE ANOTHER FLEET  "
3410 PRINT"(YES OR NO)";
3420 INPUTA$
3430 IFA$="NO"THEN3480
3435 PRINT
3440 PRINT"GOOD LUCK!"
3450 FORX=1TO100
3460 NEXT
3470 RUN
3480 CLS
3485 PRINT"SIGNING OFF."
3490 END
