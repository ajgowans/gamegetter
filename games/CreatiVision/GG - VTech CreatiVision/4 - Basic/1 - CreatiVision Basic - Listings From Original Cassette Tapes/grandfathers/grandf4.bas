1    FORX=2TO20
2    PLOTX,24,32
3    NEXT
4    FORX=5TO12
5    COLORX,12,2
6    NEXT
7    POKE851,2
15   DATA2,3,16,3,2,13,16,13
16   COLOR1,3,3
17   COLOR2,12,2
18   COLOR3,8,2
20   U=0
21   FORX=21TO29
22   PLOTX,20,15
23   NEXT
25   GOTO1852
30   N=72
40   M=192
50   FORB=1TO8-U*2
74   IFC=1ORPEEK(25)=17THEN260
78   IFC=3ORPEEK(25)=36THEN285
82   IFC=5ORPEEK(25)=3THEN310
86   IFC=7ORPEEK(20)=70THEN335
90   IFE=1ORPEEK(20)=79THENGOSUB1810
100  IFE=2ORPEEK(20)=69THENGOSUB1840
105  IFR<>1THEN200
110  SOUNDR;0
115  C=JOY(1)
116  E=JOY(3)
120  NEXT
125  Q=JOY(4)
126  IFQ=1THEN5000
130  M=M-1
140  I=INT(M/8)
150  J=M-I*8
160  PLOTI+5,24,J+16
170  IFJ=0THENPLOTI+5,24,32
180  IFM=0THEN3500
190  GOTO50
200  N=N-1
210  I=INT(N/8)
220  J=N-I*8
230  PLOTI+21,20,J+8
240  IFJ=0THENPLOTI+21,20,32
245  IFN=0THEN4000
250  GOTO110
260  D=D+2
270  IFD>4THEND=D-4
275  GOTO542
285  D=D+1
295  IFD>4THEND=D-4
300  GOTO542
310  GOSUBD*50+300
312  IFX=OANDY=PTHEN1852
315  IFR<>1THENGOSUB1810
320  GOTO545
335  D=D-1
340  IFD<1THEND=D+4
345  GOTO542
350  IFY<2THEN1510
360  IFD(X,Y-1)<0.1THEN1510
370  Y=Y-1
390  RETURN
400  IFX>16THEN1510
410  IFD(X+1,Y)<0.1THEN1510
420  X=X+1
440  RETURN
450  IFY>14THEN1510
460  IFD(X,Y+1)<0.1THEN1510
470  Y=Y+1
490  RETURN
500  IFX<2THEN1510
510  IFD(X-1,Y)<0.1THEN1510
520  X=X-1
540  RETURN
542  POKE851,0
543  GOSUBD*50+1560
544  POKE851,2
545  W=13
546  F=0
547  GOSUBD*180+370
548  GOTO110
550  FORV=Y-1TOY-4STEP-1
560  IFX=OANDV=PTHENH=G
580  IFV<1THEN700
590  IFD(X,V)<0.1THEN700
600  IFX=1THEN1390
610  IFD(X-1,V)<0.1THEN1390
620  IFD(X-1,V)>=1THEN1350
630  IFX=17THEN1470
640  IFD(X+1,V)<0.1THEN1470
650  IFD(X+1,V)>=1THEN1430
660  W=W+2
670  F=F+1
675  H=2
680  NEXT
690  RETURN
700  V=Y-4
710  NEXT
720  GOTO1260
730  FORV=X+1TOX+4
740  IFV=OANDY=PTHENH=G
760  IFV>17THEN880
770  IFD(V,Y)<0.1THEN880
780  IFY=1THEN1390
790  IFD(V,Y-1)<0.1THEN1390
800  IFD(V,Y-1)>=1THEN1350
810  IFY=15THEN1470
820  IFD(V,Y+1)<0.1THEN1470
830  IFD(V,Y+1)>=1THEN1430
840  W=W+2
850  F=F+1
855  H=2
860  NEXT
870  RETURN
880  V=X+4
890  NEXT
900  GOTO1260
910  FORV=Y+1TOY+4
940  IFV>15THEN1060
950  IFX=OANDV=PTHENH=G
955  IFD(X,V)<0.1THEN1060
960  IFX=17THEN1390
970  IFD(X+1,V)<0.1THEN1390
980  IFD(X+1,V)>=1THEN1350
990  IFX=1THEN1470
1000 IFD(X-1,V)<0.1THEN1470
1010 IFD(X-1,V)>=1THEN1430
1020 W=W+2
1030 F=F+1
1035 H=2
1040 NEXT
1050 RETURN
1060 V=Y+4
1070 NEXT
1080 GOTO1260
1090 FORV=X-1TOX-4STEP-1
1100 IFV=OANDY=PTHENH=G
1120 IFV<1THEN1230
1125 IFD(V,Y)<0.1THEN1230
1130 IFY=15THEN1390
1140 IFD(V,Y+1)<0.1THEN1390
1150 IFD(V,Y+1)>=1THEN1350
1170 IFY=1THEN1470
1175 IFD(V,Y-1)<0.1THEN1470
1180 IFD(V,Y-1)>=1THEN1430
1200 F=F+1
1205 W=W+2
1207 H=2
1210 NEXT
1220 RETURN
1230 V=X-4
1240 NEXT
1260 FORE=WTO19STEP2
1270 COLORE,S,S
1280 COLORE+1,S,S
1290 COLOR40-E,S,S
1300 COLOR41-E,S,S
1310 CHARF,FFFFFFFFFFFFFFFF
1320 CHAR7-F,FFFFFFFFFFFFFFFF
1325 F=F+1
1330 NEXT
1335 COLOR29,S,S
1340 RETURN
1350 COLORW,16,16
1360 COLOR40-W,H,2
1370 CHARF,FFFFFFFFFFFFFFFF
1380 GOTOD*180+450
1390 COLORW,T,16
1400 COLOR40-W,H,T
1410 CHARF,00
1420 GOTOD*180+450
1430 COLORW+1,16,16
1440 COLOR41-W,H,2
1450 CHAR7-F,FFFFFFFFFFFFFFFF
1460 GOTOD*180+480
1470 COLORW+1,T,16
1480 COLOR41-W,H,T
1490 CHAR7-F,00
1500 GOTOD*180+480
1510 POKE851,0
1520 POKE846,72
1530 PRINT"INVALID MOVE";
1550 FORQ=1TO100
1560 NEXT
1570 POKE846,72
1580 PRINT"            ";
1590 POKE851,2
1600 RETURN
1610 POKE846,104
1620 PRINT"NORTH";
1650 RETURN
1660 POKE846,104
1670 PRINT"EAST ";
1700 RETURN
1710 POKE846,104
1720 PRINT"SOUTH";
1750 RETURN
1760 POKE846,104
1770 PRINT"WEST ";
1800 RETURN
1810 R=SQR((X-O)*(X-O)+(Y-P)*(Y-P))
1820 R=INT(R*1.5+0.5)
1825 R=31-R
1830 RETURN
1840 R=1
1850 RETURN
1852 IFU=3THEN2250
1853 IFU=0THENP=13
1854 IFU=1THENP=5
1855 IFU=2THENP=7
1861 A$=""
1863 FORX=5TO28
1864 PLOTX,24,23
1865 NEXT
1866 DIMD(17,15)
1869 GOTO9000
1870 POKE851,0
1871 POKE846,63
1872 PRINT"WAIT WHILE MAZE IS FORMULATED.";
1873 POKE851,2
1874 FORX=1TO17
1875 FORY=1TO15
1876 D(X,Y)=0
1877 NEXT
1878 NEXT
1890 FORX=3TO15STEP2
1900 FORY=3TO13STEP2
1910 D(X,Y)=INT(1)
1920 IFD(X+1,Y+1)=1THENH=H+1
1930 IFD(X-1,Y+1)=1THENH=H+1
1940 IFD(X+1,Y-1)=1THENH=H+1
1950 IFD(X-1,Y-1)=1THENH=H+1
1960 IFH>0THEN2050
1970 FORZ=1TO2-H
1980 B=RND(3)-2
1990 C=RND(3)-2
2000 IFB=0ANDC=0THEN1980
2010 IFB<>0ANDC<>0THEN1980
2020 IFD(X+B,Y+C)=1THEN2040
2030 D(X+B,Y+C)=INT(1)
2040 NEXT
2050 H=0
2060 NEXT
2070 NEXT
2080 X=RND(17)
2090 FORQ=1TOX
2100 NEXT
2110 Y=RND(15)
2120 FORQ=1TOY
2130 NEXT
2135 IFD(X,Y)<0.1THEN2080
2140 O=RND(17)
2150 FORQ=1TOO
2160 NEXT
2170 P=RND(15)
2175 IFD(O,P)<0.1THEN2140
2180 FORE=1TO17
2190 D(E,1)=1
2200 D(E,15)=1
2205 NEXT
2210 FORF=1TO15
2215 D(1,F)=1
2220 D(17,F)=1
2240 NEXT
2244 H=2
2245 D=1
2246 A=RND(5)*2+2
2247 D(A,1)=0
2248 A=RND(5)*2+2
2249 D(A,15)=0
2250 A=RND(4)*2+2
2251 D(1,A)=0
2252 A=RND(4)*2+2
2253 D(17,A)=0
2254 FORW=1TO4
2255 READA,B
2256 D(A,B)=1
2257 NEXT
2258 D(9,9)=1
2259 D(9,11)=1
2260 R=1
2265 RESTORE
2270 POKE851,0
2275 POKE846,63
2280 PRINT"                              ";
2290 POKE851,2
2300 U=U+1
2310 GOTOU*50+2350
2400 S=4
2405 T=3
2407 G=5
2410 COLOR1,S,T
2412 PLOT9,21,49
2415 GOTO30
2450 S=8
2455 T=6
2457 G=7
2460 PLOT9,21,50
2462 M=192
2463 COLOR1,S,T
2465 GOTO110
2500 S=10
2505 T=9
2507 G=11
2510 PLOT9,21,51
2512 M=192
2514 COLOR1,S,T
2515 GOTO110
2550 POKE851,0
2555 POKE846,95
2560 PRINT"CONGRATULATIONS,YOU HAVE FOUND";
2562 POKE846,146
2565 PRINT"            ";
2567 U=0
2568 POKE846,159
2570 PRINT"YOUR GRANDFATHER'S GOLD. YOU";
2575 POKE846,202
2580 PRINT"     ";
2585 POKE846,233
2590 PRINT"WILL NOW LIVE IN LUXURY!!  ";
2593 FORX=1TO300
2594 NEXT
2595 GOSUB3000
2600 GOTO3027
3000 POKE851,0
3001 FORX=1TO32
3002 PLOTX,24,32
3003 NEXT
3005 FORQ=64TO232STEP32
3010 POKE846,Q
3020 PRINT"                               ";
3025 NEXT
3026 RETURN
3027 POKE846,97
3030 PRINT"PRESS <SHIFT> TO PLAY AGAIN,";
3032 POKE846,6
3035 PRINT"OR <CNT'L> TO END.";
3037 POKE851,2
3040 A=JOY(3)
3045 IFA=1THEN3100
3050 IFA=2THENNEW
3060 GOTO3040
3100 GOSUB3000
3105 POKE846,96
3110 PRINT"HEADING-NORTH      BATTERY";
3115 POKE846,160
3120 PRINT"LEVEL 1";
3125 POKE846,236
3130 PRINT"AIR";
3135 POKE851,2
3140 GOTO20
3500 GOSUB3000
3510 POKE846,161
3515 PRINT"YOU HAVE RUN OUT OF AIR.";
3516 FORX=1TO300
3517 NEXT
3520 GOSUB3000
3525 GOTO3027
4000 GOSUB3000
4005 POKE846,163
4010 PRINT"YOUR BATTERY IS DEAD.";
4020 FORX=1TO300
4025 NEXT
4030 GOSUB3000
4035 GOTO3027
5000 GOSUB3000
5010 GOTO3027
9000 FORM=13TO28
9001 COLORM,P,P
9005 NEXT
9010 COLOR1,P,P
9012 COLOR29,P,P
9015 GOTO1870
