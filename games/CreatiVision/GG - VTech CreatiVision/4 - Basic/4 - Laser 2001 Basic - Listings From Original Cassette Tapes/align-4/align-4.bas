5  REM  ALIGN FOUR 
10  DIM A$(99)
20  FOR W = 1 TO 54
30 A$(W) = " - "
40  NEXT 
80  DIM B(6,9)
85  DIM D(4),E(4)
100 D(1) = 0
105 D(2) = 1
110 D(3) = 1
115 D(4) =  - 1
120 E(1) = 1
125 E(2) = 0
130 E(3) = 1
135 E(4) = 1
140  FOR I = 1 TO 6
145  FOR J = 1 TO 9
150 B(I,J) = 0
155  NEXT 
160  NEXT 
165  HOME 
170  PRINT : PRINT "MOVE FIRST (Y/N) ";
175  INPUT A$
180  IF A$ = "Y" THEN 500
200  REM  COMP
201  PRINT : PRINT 
202  GOSUB 5000
205  PRINT 
207  PRINT "THINKING......"
210  PRINT "COMPUTER MOVE";" (COL)";
215  FOR I = 1 TO 9
220  FOR J = 6 TO 1 STEP  - 1
225  IF B(J,I) <  > 0 THEN 265
227  IF J = 6 THEN 230
228  IF B(J + 1,I) = 0 THEN 265
230 A = 1
245 X = I
250 Y = J
255  GOSUB 1000
260  IF F = 1 THEN 400
265  NEXT 
270  NEXT 
275  FOR I = 1 TO 9
280  FOR J = 6 TO 1 STEP  - 1
285  IF B(J,I) <  > 0 THEN 315
287  IF J = 6 THEN 290
288  IF B(J + 1,I) = 0 THEN 315
290 A = 2
295 X = I
300 Y = J
305  GOSUB 1000
310  IF F <  > 1 THEN 315
311 F = 0
312  GOTO 400
315  NEXT 
320  NEXT 
325 X =  INT (9 *  RND (10)) + 1
330 J = 6
335  IF B(J,X) = 0 THEN 355
340 J = J - 1
345  IF J = 0 THEN 325
350  GOTO 335
355 Y = J
360  PRINT X: FOR I = 1 TO 1000: NEXT 
362 A = 1
363 B(Y,X) = A
364  FOR L = 1 TO 200
365  NEXT 
366  GOSUB 3000
368  GOSUB 2000
370  GOTO 500
400 A = 1
402 J = 0
405  NEXT 
410 I = 10
415  NEXT 
416  GOSUB 3000
417  PRINT X: FOR I = 1 TO 1000: NEXT 
419 B(Y,X) = A
420  FOR L = 1 TO 200
422  NEXT 
424  GOSUB 2000
500  REM  YOU
502 A = 2
503  PRINT : PRINT 
504  GOSUB 5000
505  PRINT 
510  PRINT "YOU MOVE (COL)"
515  INPUT X
520  IF X < 1 OR X > 9 THEN 505
525 Y = 6
530  IF B(Y,X) = 0 THEN 545
535 Y = Y - 1
540  IF Y = 0 THEN 505
541  GOTO 530
545 B(Y,X) = A
546  GOSUB 1000
550  GOSUB 2000
552  GOSUB 4000
555  GOTO 200
1000 F = 0
1002  FOR M = 1 TO 4
1005 H = X
1010 K = Y
1015 C = 1
1020 H = H + D(M)
1025 K = K + E(M)
1030  IF H < 1 OR H > 9 THEN 1100
1035  IF K < 1 OR K > 6 THEN 1100
1040  IF A <  > B(K,H) THEN 1100
1045 C = C + 1
1050  GOTO 1020
1100 H = X
1105 K = Y
1110 H = H - D(M)
1115 K = K - E(M)
1120  IF H < 1 OR H > 9 THEN 1145
1125  IF K < 1 OR K > 6 THEN 1145
1130  IF A <  > B(K,H) THEN 1145
1135 C = C + 1
1140  GOTO 1110
1145  IF C = 4 THEN 1160
1150  NEXT 
1155  RETURN 
1160 M = 5
1161  NEXT 
1162 F = 1
1165  RETURN 
2000  IF F = 1 THEN 2025
2002  FOR I = 1 TO 9
2005  FOR J = 1 TO 6
2010  IF B(J,I) = 0 THEN 2100
2015  NEXT 
2020  NEXT 
2025  REM 
2030  IF A = 1 THEN  PRINT " COMP WIN!!"
2035  IF A = 2 THEN  PRINT "  YOU WIN!!"
2040  PRINT 
2045  PRINT " TRY AGAIN (Y/N) "
2050  INPUT A$
2055  IF A$ <  > "N" THEN  RUN 
2056  HOME : PRINT : PRINT 
2057  PRINT "       END OF PROGRAM!!"
2060  END 
2100 J = 7
2105  NEXT 
2110 I = 10
2115  NEXT 
2120  HOME 
2160  FOR J = 1 TO 9
2180  NEXT 
2185  PRINT 
2190 D =  INT (30 *  RND (7)) + 1
2195  SOUND (D,10,15)
2205  RETURN 
3000  IF X = 1 THEN W = X + Y - 1
3010  IF X = 2 THEN W = X + Y + 4
3020  IF X = 3 THEN W = X + Y + 9
3030  IF X = 4 THEN W = X + Y + 14
3040  IF X = 5 THEN W = X + Y + 19
3050  IF X = 6 THEN W = X + Y + 24
3053  IF X = 7 THEN W = X + Y + 29
3056  IF X = 8 THEN W = X + Y + 34
3059  IF X = 9 THEN W = X + Y + 39
3060 A$(W) = " # "
3070  RETURN 
4000  IF X = 1 THEN W = X + Y - 1
4010  IF X = 2 THEN W = X + Y + 4
4020  IF X = 3 THEN W = X + Y + 9
4030  IF X = 4 THEN W = X + Y + 14
4040  IF X = 5 THEN W = X + Y + 19
4050  IF X = 6 THEN W = X + Y + 24
4053  IF X = 7 THEN W = X + Y + 29
4056  IF X = 8 THEN W = X + Y + 34
4059  IF X = 9 THEN W = X + Y + 39
4060 A$(W) = " @ "
4070  RETURN 
5000  PRINT : PRINT : FOR L = 1 TO 9: PRINT " ";L;" ";: NEXT 
5003  PRINT : PRINT : FOR O = 1 TO 54 STEP 6: PRINT A$(O);: NEXT 
5005  PRINT : PRINT 
5010  FOR O = 2 TO 54 STEP 6: PRINT A$(O);: NEXT 
5015  PRINT : PRINT 
5020  FOR O = 3 TO 54 STEP 6: PRINT A$(O);: NEXT 
5025  PRINT : PRINT 
5030  FOR O = 4 TO 54 STEP 6: PRINT A$(O);: NEXT 
5035  PRINT : PRINT 
5040  FOR O = 5 TO 54 STEP 6: PRINT A$(O);: NEXT 
5045  PRINT : PRINT 
5050  FOR O = 6 TO 54 STEP 6: PRINT A$(O);: NEXT 
5052  PRINT : PRINT 
5055  RETURN 
