50  HOME : COLOR= 1,15
110  PRINT 
120  PRINT "   TEKSTINKASITTELY"
125  PRINT 
130  PRINT "   VALITSE TOIMINTA"
135  PRINT 
140  PRINT "   1 syotto"
145  PRINT 
150  PRINT "   2 oikean laidan tasaus"
155  PRINT 
160  PRINT "   5 tulostus"
165  PRINT 
170  PRINT "   4 nauhalle luku"
175  PRINT 
180  PRINT "   5 nauhalta luku"
185  PRINT 
195  PRINT "   @ paluu valikkoon"
220  GET A%
230  IF A% < 1 OR A% > 5 THEN  GOTO 220
240  ON A% GOSUB 1000,2600,3000,4000,5000
250  GOTO 50
1000  HOME : PRINT "ALOITATKO UUDEN SI VUN (K/E)?": GET A$: IF A$ = "K" THEN  GOSUB 6000
1005  HOME :I = 0:K = 60
1010  PRINT "MILTA RIVILTA ALOITAT?": INPUT M
1020  IF M < 1 OR M > 39 THEN  GOTO 1010
1030 J = (M - 1) * K
1040 D = M - 2
1045 I = 0:X =  - 31500
1050  HOME 
1052  IF J < 2 * K THEN  GOTO 1064
1060  FOR O = X + J - 2 * K TO X + J + 3 * K - 1
1062  GOTO 1070
1064 D = J / K + 1: FOR O = X + J TO X + J + 3 * K - 1
1070  IF I = 30 THEN  PRINT  CHR$ (13);
1075 C =  PEEK (0)
1080  IF C = 255 THEN C = 32
1085  PRINT  CHR$ (C);
1087 I = I + 1: IF I > 59 THEN  PRINT "#";D;:D = D + 1: PRINT  CHR$ (13);:I = 0
1090  NEXT O
1100  FOR H = 1 TO 6: PRINT  CHR$ (5);: NEXT H:D = D - 3
1140  GET B$:B =  ASC (B$)
1144  IF B = 21 AND I = 0 THEN  GOTO 1140
1145  IF B = 21 AND I = 30 THEN  FOR P = 1 TO 7: PRINT  CHR$ (21);: NEXT P:I = I - 1: GOTO 1140
1150  IF B = 21 THEN I = I - 1: PRINT  CHR$ (B);: GOTO 1140
1152  IF B = 8 AND I = 29 THEN  PRINT  CHR$ (13);:I = I + 1: GOTO 1140
1153  IF B = 8 AND I = 60 THEN  GOTO 1140
1154  IF B = 8 THEN I = I + 1: PRINT  CHR$ (B);: GOTO 1140
1160  IF B > 64 AND B < 94 THEN B = B + 32: GOTO 1180
1170  IF B > 96 AND B < 127 THEN B = B - 32
1180  IF B = 64 THEN  GOTO 1900
1185  IF B <  > 13 THEN  GOTO 1200
1190  IF B = 13 AND I = 60 THEN  PRINT "#";D
1191  IF B = 13 AND I > 30 AND I < 60 THEN  FOR P = I TO 59: PRINT  CHR$ (8);: NEXT P: PRINT "#";D
1192  IF B = 13 AND I < 31 THEN  FOR P = I TO 65: PRINT  CHR$ (8);: NEXT P: PRINT "#";D
1193 D = D + 1:J = J + K:I = 0: IF J = 2460 THEN  PRINT "SIVU TAYNNA": GET A$: GOTO 1900
1195  GOTO 1140
1200  IF B = 5 AND J = 0 THEN  GOTO 1140
1202  IF B = 5 THEN J = J - K: PRINT  CHR$ (5);: PRINT  CHR$ (5);:D = D - 1: GOTO 1140
1204  IF B = 24 AND J = 40 * K THEN  GOTO 1140
1205  IF B = 24 THEN J = J + K: PRINT  CHR$ (24);: PRINT  CHR$ (24);:D = D + 1: GOTO 1140
1210  IF B = 15 THEN  FOR L = X + J + I TO X - 1 + J + K:S =  PEEK (L + 1): POKE L,S: NEXT L: POKE X - 1 + J + K,32: PRINT  CHR$ (B);: GOTO 1140
1220  IF B = 16 THEN  FOR L = X - 1 + J + K TO X + 1 + J + I STEP  - 1:S =  PEEK (L - 1): POKE L,S: NEXT L: POKE X + J + I,32: PRINT  CHR$ (B);: GOTO 1140
1230  IF B = 23 THEN  HOME : GOTO 1010
1235  IF B = 10 THEN  GOTO 2400
1240  IF B = 18 THEN  GOTO 2500
1250  IF I = 55 THEN  SOUND (200,3,15)
1260  IF I = 60 THEN I = I - 1: PRINT  CHR$ (21);
1300  PRINT  CHR$ (B);: POKE X + J + I,B:I = I + 1: IF I = 30 THEN  PRINT  CHR$ (13);
1305  GOTO 1140
1900  RETURN 
2400  REM 
2420  FOR G =  - 31500 + J TO  - 29000
2430 C =  PEEK (G + 60)
2440  POKE G,C
2450  NEXT G
2480 D = J / K - 1
2490  GOTO 1050
2500  REM 
2520  FOR G =  - 29039 TO X + J + K STEP  - 1
2530 C =  PEEK (G - 60)
2540  POKE G,C
2545  POKE (G - 60),32
2550  NEXT G
2585 D = J / K - 1
2590  GOTO 1050
2600  HOME :K = 60
2610  FOR M = 0 TO 40
2620  FOR I =  - 31500 + M * K TO  - 31441 + M * K
2625 C =  PEEK (I)
2630  PRINT  CHR$ (C);
2635  NEXT I
2640  PRINT  CHR$ (13);
2645  GET A$: IF A$ = "@" THEN  GOTO 2900
2647  IF A$ <  >  CHR$ (13) THEN  GOTO 2700
2650  NEXT M
2660  GET A$: GOTO 2900
2700  FOR V =  - 31449 + M * K TO  - 31441 + M * K:E =  PEEK (V): IF E <  > 32 AND E <  > 255 THEN  GOTO 2703
2701  NEXT V
2702  GOTO 2650
2703  FOR J =  - 31500 + M * K TO  - 31441 + M * K
2705 E =  PEEK (J)
2710 W =  PEEK ( - 31441 + M * K): IF W <  > 255 AND W <  > 32 THEN  GOTO 2810
2715  IF E = 32 OR E = 255 THEN  FOR L =  - 31441 + M * K TO J + 1 STEP  - 1:S =  PEEK (L - 1): POKE L,S: NEXT L:J = J + 2
2720  NEXT J
2810  PRINT  CHR$ (5);: PRINT  CHR$ (5);
2820  FOR H =  - 31500 + M * K TO  - 31441 + M * K
2825 C =  PEEK (H)
2830  PRINT  CHR$ (C);
2835  NEXT H
2840  PRINT  CHR$ (13);
2850  GOTO 2650
2900  RETURN 
3000  HOME :D = 0:F = 1:X =  - 3150O
3010  PRINT : PRINT "HALUATKO TEKSTIN PAPERILLE?(K/E)": GET K$: IF K$ = "K" THEN  GOTO 3105
3015  IF K$ = "@" THEN  GOTO 50
3020  FOR I = X TO  - 29041
3025 D = D + 1: IF D > 60 THEN  PRINT "#";F;:F = F + 1: PRINT  CHR$ (13);:D = 1
3027  IF D = 31 THEN  PRINT  CHR$ (13);
3030 C =  PEEK (I)
3035  IF C = 255 THEN C = 32
3040  PRINT  CHR$ (C);
3050  NEXT I
3060  PRINT "#";F
3065  GET A$
3070  GOTO 3900
3105  PRINT "VALITSE VASEN REUNAESTE": INPUT X
3110 D = 1:A$ = ""
3115  LPRINT  TAB( X)
3120  FOR I =  - 31500 TO  - 29041
3130 C =  PEEK (I)
3133  IF C = 255 THEN C = 32
3135 A$ = A$ +  CHR$ (C)
3140  IF  LEN (A$) = 3 THEN  LPRINT A$;:A$ = ""
3160 D = D + 1: IF D > 60 THEN  LPRINT  CHR$ (C); CHR$ (13); TAB( X);:D = 1
3190  NEXT I
3200  GET A$
3900  RETURN 
4000  HOME 
4100  PRINT "LATTA NAUHURI AANITYSASENTOON"
4120  PRINT "PAINA MITA TAHANSA NAPPULAA"
4130  PRINT : PRINT "AANITYS KESTAA NOIN 23 SEKUNTIA"
4150  GET W$
4170  IF W$ = "@" THEN  GOTO 4900
4200  BSAVE $4F4,$99C
4900  RETURN 
5000  HOME 
5010  PRINT "KELAA NAUHA HALUTTUUN KOHTAAN"
5020  PRINT "PAINA MITA TAHANSA NAPPULAA,"
5030  PRINT "NIIN OHJELMAN LUKU ALKAA"
5040  GET W$
5050  IF W$ = "@" THEN  GOTO 5900
5100  BLOAD $4F4
5900  RETURN 
6000  HOME 
6008  PRINT "ODOTA 13 SEKUNTIA"
6010  FOR I =  - 31502 TO  - 29000
6020  POKE I,32
6030  NEXT I
6900  RETURN 
