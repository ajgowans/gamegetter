1 REM XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
2 REM ****************************
3 REM * PIPELINE - HAUPTPROGRAMM *
4 REM * fuer LASER 2001+Joystick *
5 REM *--------------------------*
6 REM *  (c) 1984 by Tronicsoft  *
7 REM *  all Rights by V.Becker  *
8 REM ****************************
9 REM
12 DIM C(2)
15 FOR I=59968 TO 59988 : POKE I-39482,PEEK(I) : NEXT I
20 POKE 20489,19 : POKE 20490,80 : POKE 20497,96 : POKE 20498,234
30 POKE 20499,0 : POKE 20500,226 : POKE 20501,8 : POKE 20502,1 : POKE 20503,1 : POKE 20504,6 : POKE 20505,1 : POKE 20506,13
40 BA=40959 : W=0 : GOSUB 60000
45 RESTORE
47 FOR I=1 TO 12 : READ S : NEXT I : GOSUB 61000 : GOSUB 61100
50 LB=3 : LV=1 : ST=0
55 W=1
60 VPOKE 33535,8 : VPOKE 33536,208 : VPOKE 33537,84 : VPOKE 33538,7 : VPOKE 33539,8 : VPOKE 33540,208 : VPOKE 33541,136 : VPOKE 33542,11 : VPOKE 33543,8 : VPOKE 33544,224 : VPOKE 33545,168 : VPOKE 33546,2
62 VPOKE 33567,165 : VPOKE 33568,168 : VPOKE 33569,124 : VPOKE 33570,1
65 VPOKE 33543,8 : VPOKE 33544,224 : VPOKE 33545,168 : VPOKE 33537,84
70 FOR I=208 TO 16 STEP -1 : VPOKE 33536,I : VPOKE 33540,I : VPOKE 33544,I+16
80 IF NOT((I/2)-INT(I/2)) THEN VPOKE 33541,136 : VPOKE 33545,168 : VPOKE 33570,1 : GOTO 95
90 VPOKE 33541,140 : VPOKE 33545,172 : VPOKE 33570,8
95 CALL -1536 : IF PEEK(24)>100 THEN 400
100 NEXT I
105 VPOKE 33543,232 : VPOKE 33544,216 : VPOKE 33545,160 : VPOKE 33537,80
110 FOR I=16 TO 208 : VPOKE 33536,I : VPOKE 33540,I : VPOKE 33543,232-I
120 IF NOT((I/2)-INT(I/2)) THEN VPOKE 33541,128 : VPOKE 33545,160 : VPOKE 33570,1 : GOTO 195
130 VPOKE 33541,132 : VPOKE 33545,164 : VPOKE 33570,8
195 CALL -1536 : IF PEEK(24)>100 THEN 400
200 NEXT I
210 GOTO 65
400 GOSUB 60300 : P=0
500 FOR I=33535 TO 33546 : VPOKE I,0 : NEXT I : VPOKE 33570,1
510 GOSUB 60000
515 ZM=34 : SM=16 : SD=1 : ZK=176 : SK=216 : MW=1 : SL=0
520 RESTORE
525 VPOKE 32861,161 : FOR ZB=36766 TO 36607+(8*(LV-1)) STEP -1 : VPOKE ZB,60 : NEXT ZB
530 FOR I=33535 TO 33546 : READ S : VPOKE I,S : NEXT I : GOSUB 61000
535 FOR LP=1 TO 2
540 CALL -1536
545 IF PEEK(24)>100 THEN GOSUB 40000 : CALL -1536
550 JS=PEEK(24)-(PEEK(24)>100)*128
560 IF NOT JS THEN 590
570 JS=JS/2 : IF JS>10 THEN 5000
580 ON JS GOSUB 10000,10100,10200,10300,10800,10400
585 GOTO 600
590 FOR DL=1 TO 90 : NEXT DL
595 ON MW GOSUB 27000,27100,27200,27300,27400,27500,28000
600 ON LP GOSUB 25000,25100
605 NEXT LP
610 IF ST THEN 30000
615 GOTO 535
5000 JS=JS-15
5010 ON JS GOSUB 10500,10600,10800,10800,10700
5020 GOTO 600
10000 ZM=ZM+2 : ON SD GOSUB 21000,23000
10010 GOSUB 20100 : GOSUB 20000 : ZM=ZM+2 : ON SD GOSUB 22000,24000
10020 GOSUB 20100,20000 : RETURN
10100 SM=SM+2 : GOSUB 21000 : GOSUB 20100 : GOSUB 20000 : SM=SM+2 : GOSUB 22000 : GOSUB 20100 : GOSUB 20000 : RETURN
10200 ZM=ZM+2 : SM=SM+2 : GOSUB 21000 : GOSUB 20100 : GOSUB 20000 : ZM=ZM+2 : SM=SM+2 : GOSUB 22000 : GOSUB 20100 : GOSUB 20000 : RETURN
10300 ZM=ZM-2 : ON SD GOSUB 21000,23000
10310 GOSUB 20100 : GOSUB 20000 : ZM=ZM-2 : ON SD GOSUB 22000,24000
10320 GOSUB 20100,20000 : RETURN
10400 ZM=ZM-2 : SM=SM+2 : GOSUB 21000 : GOSUB 20100 : GOSUB 20000 : ZM=ZM-2 : SM=SM+2 : GOSUB 22000 : GOSUB 20100 : GOSUB 20000 : RETURN
10500 SM=SM-2 : GOSUB 23000 : GOSUB 20100 : GOSUB 20000 : SM=SM-2 : GOSUB 24000 : GOSUB 20100 : GOSUB 20000 : RETURN
10600 ZM=ZM+2 : SM=SM-2 : GOSUB 23000 : GOSUB 20100 : GOSUB 20000 : ZM=ZM+2 : SM=SM-2 : GOSUB 24000 : GOSUB 20100 : GOSUB 20000 : RETURN
10700 ZM=ZM-2 : SM=SM-2 : GOSUB 23000 : GOSUB 20100 : GOSUB 20000 : ZM=ZM-2 : SM=SM-2 : GOSUB 24000 : GOSUB 20100 : GOSUB 20000 : RETURN
10800 RETURN
20000 VPOKE 33535,ZM : VPOKE 33536,SM : VPOKE 33539,ZM : VPOKE 33540,SM : GOSUB 26000
20010 ON MW GOSUB 27000,27100,27200,27300,27400,27500,28000
20020 RETURN
20100 SM=(SM>=216)*216+(SM<=16)*16+((SM>16) AND (SM<216))*SM
20200 ZM=(ZM>=176)*176+(ZM<=34)*34+((ZM>34) AND (ZM<176))*ZM : RETURN
21000 SD=1 : VPOKE 33537,80 : VPOKE 33541,132 : SOUND(165,1,15) : RETURN
22000 VPOKE 33537,80 : VPOKE 33541,128 : SOUND(148,1,15) : RETURN
23000 SD=2 : VPOKE 33537,84 : VPOKE 33541,140 : SOUND(165,1,15) : RETURN
24000 VPOKE 33537,84 : VPOKE 33541,136 : SOUND(148,1,15) : RETURN
25000 IF SL THEN RETURN
25010 VPOKE 33570,8 : RETURN
25100 IF SL THEN 25110
25105 VPOKE 33570,1
25110 IF NOT (ZB-36767) THEN ST=1
25115 IF ZB=36735 THEN VPOKE 32861,145 : SOUND(195,2,15) : SOUND(175,2,15) : SOUND(195,2,15)
25120 VPOKE ZB,0 : ZB=ZB+1 : RETURN
26000 ST=0 : Z=32*INT(ZM/8+2) : S=INT(SM/8) : IF VPEEK(WI+2+Z+S)=32 THEN ST=1
26010 RETURN
27000 ZK=ZK-4 : VPOKE 33543,ZK : VPOKE 33545,160 : IF ZK<=24 THEN VPOKE 33543,8 : MW=4 : EW=INT(RND(255)*176)+24 : RETURN
27010 MW=2 : RETURN
27100 ZK=ZK-4 : VPOKE 33543,ZK : VPOKE 33545,164 : IF ZK<=24 THEN VPOKE 33543,8 : MW=3 : EW=INT(RND(255)*176)+24 : RETURN
27110 MW=1 : RETURN
27200 SK=SK-4 : VPOKE 33544,SK : VPOKE 33545,168 : IF SK<=EW THEN MW=6 : RETURN
27210 MW=4 : RETURN
27300 SK=SK-4 : VPOKE 33544,SK : VPOKE 33545,172 : IF SK<=EW THEN MW=5 : RETURN
27310 MW=3 : RETURN
27400 ZK=ZK+4 : VPOKE 33543,ZK : VPOKE 33545,176 : IF ZK>=176 THEN ZK=176 : MW=2 : SK=216 : VPOKE 33544,SK : GOTO 27420
27410 MW=6 : GOSUB 27600
27420 RETURN
27500 ZK=ZK+4 : VPOKE 33543,ZK : VPOKE 33545,180 : IF ZK>=176 THEN ZK=176 : MW=1 : SK=216 : VPOKE 33544,SK : GOTO 27420
27510 MW=5 : GOSUB 27600 : RETURN
27600 SL=0 : Z1=32*INT(ZK/8+2) : S1=INT(SK/8) : VG=VPEEK(WI+2+Z1+S1)
27610 IF ((VG>63) AND (VG<72)) OR ((VG>75) AND (VG<80)) THEN SL=1
27615 IF (ABS(SM-SK)<12) AND (ABS(ZM-ZK)<12) THEN ST=1
27620 IF NOT SL THEN RETURN
27630 CP=WI+1+Z1+S1 : VPOKE CP,73 : VPOKE 33546,0 : ZK=176 : SK=216 : VPOKE 33543,ZK : VPOKE 33544,SK : MW=7 : VPOKE 33570,1
27640 RETURN
28000 Z2=32*INT(ZM/8+2) : S2=INT(SM/8) : IF VPEEK(WI+2+Z2+S2)=73 THEN 28100
28010 RETURN
28100 ON SD GOTO 28110,28120
28110 C(1)=144 : C(2)=152 : GOTO 28130
28120 C(1)=148 : C(2)=156
28130 VPOKE 33538,0
28140 FOR R=1 TO 10 : FOR I=1 TO 2 : VPOKE 33541,C(I) : IF I/2=INT(I/2) THEN SOUND(135,3,15) : GOTO 28160
28150 SOUND(16,3,15)
28160 NEXT I : NEXT R
28170 IF NOT(SD-1) THEN VPOKE 33541,132 : GOTO 28190
28180 VPOKE 33541,140
28190 VPOKE 33538,7 : MW=1 : SL=0 : VPOKE CP,VG : VPOKE 33546,2 : RETURN
30000 IF ABS(ZM-165)<12 AND ABS(SM-168)<16 THEN 31000
30005 FOR FL=ZM TO 181 STEP 2 : VPOKE 33535,FL : VPOKE 33539,FL : SOUND(286-FL,1,15) : NEXT FL
30010 VPOKE 33538,0 : VPOKE 33541,92
30012 SOUND(255,1,0),(255,1,0),(255,1,0)
30014 SGEN 228
30016 FOR I=240 TO 255 : SGEN I : FOR D=0 TO 75 : NEXT D : NEXT I : GOSUB 60400
30020 IF NOT SL THEN 30025
30022 VPOKE CP,VG
30025 FOR L=ZB TO 36766 : VPOKE L,0 : NEXT L
30030 IF NOT LB THEN 40
30035 ST=0 : GOTO 500
31000 IF SL THEN 30005
31002 P=P+500*LV : GOSUB 60200 : GOSUB 61100
31005 LV=LV+1 : IF LV>8 THEN LV=8
31010 W=W+1 : IF W>3 THEN W=1
31020 SGEN 228,255 : FOR L=ZB TO 36766 : P=P+2*LV : SGEN 190,240 : GOSUB 60200 : SGEN 255 : VPOKE L,0 : NEXT L
31025 GOTO 30030
40000 IF MW=3 OR MW=4 THEN RETURN
40002 IF SD=1 AND SK<SM THEN RETURN
40004 IF SD=2 AND SK>SM THEN RETURN
40006 IF SL THEN RETURN
40010 VPOKE 33547,ZM : VPOKE 33548,SM : VPOKE 33549,148 : VPOKE 33550,14
40020 FOR I=SM TO SK STEP 8*SGN(SK-SM)
40030 VPOKE 33548,I : ON SD GOSUB 40100,40200
40035 SOUND(135,1,15)
40040 VPOKE 33548,I+4 : ON SD GOSUB 40300,40400
40045 SOUND(16,1,15)
40050 NEXT I
40060 VPOKE 33550,0 : IF ABS(ZK-ZM)>(14-LV) THEN RETURN
40070 FOR I=ZK TO 185 STEP 2 : VPOKE 33543,I : SOUND(186-I,1,15) : NEXT I
40080 SK=216 : ZK=176 : VPOKE 33543,ZK : VPOKE 33544,SK : VPOKE 33545,160 : MW=2
40090 P=P+5*LV : GOSUB 60200 : RETURN
40100 VPOKE 33549,144 : RETURN
40200 VPOKE 33549,148 : RETURN
40300 VPOKE 33549,152 : RETURN
40400 VPOKE 33549,156 : RETURN
60000 WI=BA+W*1024 : WA=W+8 : GOSUB 60100 : GOSUB 60200 : POKE 20501,WA : CALL 20486 : RETURN
60100 VPOKE 29+WI,LV+48 : RETURN
60200 A=RAM(P$) : P$=STR$(P) : FOR PA=1 TO LEN(P$) : VPOKE WI+6+PA,ASC(MID$(P$,PA,1)) : NEXT PA : RETURN
60300 FOR I=0 TO 3 : AD=40959+I*1024 : FOR K=6 TO 20 : VPOKE AD+K,32 : NEXT K
60310 FOR K=17 TO 19 : VPOKE AD+K,204 : NEXT K : NEXT I : RETURN
60400 FOR I=0 TO 3 : AD=40959+I*1024+16 : VPOKE AD+LB,32 : NEXT I : LB=LB-1 : RETURN
61000 FOR I=1 TO 18 : READ L,G1,G2 : SOUND(G1,L,15),(G2,L,15) : NEXT I : RETURN
61100 FOR I=1 TO 10 : READ L,G1,G2 : SOUND(G1,L,15),(G2,L,15) : NEXT I : RETURN
62000 DATA 34,16,80,7,34,16,128,11,176,216,160,2
62010 DATA 6,175,160,6,160,135,3,165,148,3,160,135,6,148,128,6,160,135,6,135,113,3,148,128,3,135,113,6,128,95
62020 DATA 6,135,113,6,113,75,6,95,65,6,165,148,3,160,135,3,165,148,6,148,75,12,135,65
62030 DATA 3,184,165,3,175,160,6,165,148,3,175,160,3,165,148,6,160,135,3,165,148,3,160,135,6,148,75,12,135,65
